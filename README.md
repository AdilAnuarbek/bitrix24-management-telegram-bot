# Telegram-бот для уведомлений о лидах из Bitrix24

Этот бот предназначен для менеджеров, работающих с Bitrix24. Он помогает отслеживать "забытые" лиды, отправляя уведомления в Telegram и позволяя быстро реагировать на них, изменяя их статус прямо из чата.

## Возможности

* **Гибкое управление**: Автоматическую проверку можно в любой момент включить или выключить.
* **Интерактивные действия**: По каждому лиду можно совершить действие (Позвонил, Написал, Отложить), нажав на кнопку.
* **Интеграция с CRM**: Действия в боте автоматически добавляют комментарий для лида или создают задачу в Bitrix24.

## Настройка

### Шаг 1: Настройка в Bitrix24

Прежде чем запускать бота, необходимо подготовить ваш портал Bitrix24.

1.  **Получите Webhook**:
    * Зайдите в ваш портал Bitrix24 с правами администратора.
    * Перейдите в `Разработчикам` -> `Другое` -> `Входящий веб-хук`.
    * В правах веб-хука выберите **CRM** и **Задачи (task)**. Сохраните.
    * Система сгенерирует уникальный URL. **Этот URL вам нужно будет добавить в .env файле**.

### Шаг 2: Настройка проекта

1.  **Переименуйте файл** `.env.template` на `.env` в корневой папке проекта. В него нужно добавить только токен и manager ID вашего Telegram-бота:
    ```
    TELEGRAM_TOKEN=ваш_телеграм_токен
    MANAGER_TELEGRAM_ID=ваш_manager_id
    ```
2. Также в файле .env добавьте уникальный URL вашего Webhook с сайта Bitrix24:
    ```
    BITRIX_WEBHOOK=ваш.url        
    ```

3. **Установите зависимости**, выполнив в терминале:
    ```bash
    pip install -r requirements.txt
    ```

## Запуск

Для запуска бота выполните команду в терминале из папки проекта:

```bash
python bot.py
```

## Использование

### Первый запуск

1.   Вам достаточно следовать инструкциям бота или написать `/start`.

### Доступные команды

* `/start` - Регистрация или приветствие.
* `/check_leads` - Ручной запуск проверки просроченных лидов.
* `/turn_on_periodic_check` - Включить автоматическую проверку лидов каждые 30 минут.
* `/turn_off_periodic_check` - Выключить автоматическую проверку.
